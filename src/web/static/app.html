<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' ws: wss:; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self';">
<meta name="referrer" content="strict-origin-when-cross-origin">
<title>Starrain-BOT ç®¡ç†åå°</title>
<link rel="stylesheet" href="/static/css/main.css">
<script src="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js" crossorigin="anonymous"></script>
</head>
<body>
<div id="app">
<aside class="sidebar">
<div class="sidebar-header">
<div class="sidebar-brand">Starrain-BOT</div>
<div class="sidebar-status">
<span class="status-dot" :class="{disconnected:!wsConnected}"></span>
<span>{{ wsConnected ? 'å®æ—¶è¿æ¥' : 'è¿æ¥æ–­å¼€' }}</span>
</div>
</div>
<nav class="sidebar-nav">
<div class="nav-item" :class="{active:page==='dashboard'}" @click="page='dashboard'"><span>ğŸ“Š</span> ä»ªè¡¨ç›˜</div>
<div class="nav-item" :class="{active:page==='message'}" @click="page='message';loadContacts()"><span>ğŸ’¬</span> æ¶ˆæ¯å‘é€</div>
<div class="nav-item" :class="{active:page==='plugins'}" @click="page='plugins'"><span>ğŸ”Œ</span> æ’ä»¶ç®¡ç†</div>
<div class="nav-item" :class="{active:page==='permissions'}" @click="page='permissions'"><span>ğŸ‘¥</span> æƒé™ç®¡ç†</div>
<div class="nav-item" :class="{active:page==='blacklist'}" @click="page='blacklist'"><span>ğŸš«</span> ç¾¤é»‘åå•</div>
<div class="nav-item" :class="{active:page==='logs'}" @click="page='logs'"><span>ğŸ“‹</span> å®æ—¶æ—¥å¿—</div>
<div class="nav-item" :class="{active:page==='system'}" @click="page='system'"><span>âš™ï¸</span> ç³»ç»Ÿæ“ä½œ</div>
<div class="nav-item" @click="doLogout" style="margin-top:auto;border-top:1px solid var(--border-color);padding-top:16px"><span>ğŸšª</span> é€€å‡ºç™»å½•</div>
</nav>
</aside>
<main class="main-content">
<div v-if="page==='dashboard'">
<div class="page-header"><h1 class="page-title">ä»ªè¡¨ç›˜</h1><p class="page-desc">æœºå™¨äººè¿è¡ŒçŠ¶æ€æ¦‚è§ˆ</p></div>
<div class="stats-grid">
<div class="stat-card"><div class="stat-label">æœºå™¨äººQQ</div><div class="stat-value">{{ status.qq || '-' }}</div></div>
<div class="stat-card"><div class="stat-label">è¿è¡Œæ—¶é—´</div><div class="stat-value success">{{ status.uptime_formatted || '-' }}</div></div>
<div class="stat-card"><div class="stat-label">å·²åŠ è½½æ’ä»¶</div><div class="stat-value">{{ status.plugins_count || 0 }} / {{ status.enabled_plugins_count || 0 }}</div></div>
<div class="stat-card"><div class="stat-label">è¿è¡ŒçŠ¶æ€</div><div class="stat-value" :class="status.running?'success':'danger'">{{ status.running?'è¿è¡Œä¸­':'å·²åœæ­¢' }}</div></div>
</div>
<div class="card">
<h3 class="card-title">ğŸ–¥ï¸ é€‚é…å™¨çŠ¶æ€</h3>
<div class="table-container">
<table><thead><tr><th>é€‚é…å™¨</th><th>çŠ¶æ€</th></tr></thead>
<tbody><tr v-for="a in status.adapters" :key="a.name"><td>{{ a.name }}</td><td><span class="badge" :class="a.connected?'badge-success':'badge-danger'">{{ a.connected?'å·²è¿æ¥':'æœªè¿æ¥' }}</span></td></tr></tbody>
</table>
</div>
</div>
<div class="card" v-if="status.system">
<h3 class="card-title">ğŸ’» ç³»ç»Ÿä¿¡æ¯</h3>
<div class="stats-grid">
<div class="stat-card"><div class="stat-label">Pythonç‰ˆæœ¬</div><div class="stat-value">{{ status.system.python }}</div></div>
<div class="stat-card"><div class="stat-label">æ“ä½œç³»ç»Ÿ</div><div class="stat-value">{{ status.system.platform }}</div></div>
<div class="stat-card"><div class="stat-label">CPUä½¿ç”¨</div><div class="stat-value">{{ status.system.cpu_percent }}%</div></div>
<div class="stat-card"><div class="stat-label">å†…å­˜ä½¿ç”¨</div><div class="stat-value">{{ status.system.memory.percent }}%</div><div class="progress-bar"><div class="progress-fill" :style="{width:status.system.memory.percent+'%'}"></div></div></div>
</div>
</div>
</div>

<div v-if="page==='message'">
<div class="page-header"><h1 class="page-title">æ¶ˆæ¯å‘é€</h1><p class="page-desc">å‘å¥½å‹æˆ–ç¾¤å‘é€æ¶ˆæ¯</p></div>
<div class="card">
<div class="tab-container">
<button class="tab-btn" :class="{active:msgTab==='group'}" @click="msgTab='group'">ç¾¤èŠ</button>
<button class="tab-btn" :class="{active:msgTab==='private'}" @click="msgTab='private'">ç§èŠ</button>
</div>
<div class="message-panel">
<div class="card" style="margin:0">
<h3 class="card-title">{{ msgTab==='group'?'ç¾¤åˆ—è¡¨':'å¥½å‹åˆ—è¡¨' }}</h3>
<div class="contact-list">
<div v-if="contactsLoading" class="empty-state">åŠ è½½ä¸­...</div>
<template v-else-if="msgTab==='group'">
<div class="contact-item" v-for="g in groups" :key="g.group_id" :class="{selected:selected===g.group_id}" @click="selected=g.group_id"><div style="font-weight:600">{{ g.group_name || g.group_id }}</div><div style="font-size:12px;color:var(--text-secondary)">{{ g.group_id }} Â· {{ g.member_count || '?' }}äºº</div></div>
<div class="empty-state" v-if="groups.length===0">æš‚æ— ç¾¤</div>
</template>
<template v-else>
<div class="contact-item" v-for="f in friends" :key="f.user_id" :class="{selected:selected===f.user_id}" @click="selected=f.user_id"><div style="font-weight:600">{{ f.nickname || f.user_id }}</div><div style="font-size:12px;color:var(--text-secondary)">{{ f.user_id }}</div></div>
<div class="empty-state" v-if="friends.length===0">æš‚æ— å¥½å‹</div>
</template>
</div>
</div>
<div class="message-input-area">
<div class="form-group"><label class="form-label">{{ msgTab==='group'?'ç¾¤å·':'QQå·' }}</label><input type="text" class="form-input" v-model.number="selected" :placeholder="msgTab==='group'?'è¾“å…¥ç¾¤å·':'è¾“å…¥QQå·'"></div>
<div class="form-group"><label class="form-label">æ¶ˆæ¯å†…å®¹</label><textarea class="form-input message-input" v-model="msgContent" placeholder="è¾“å…¥è¦å‘é€çš„æ¶ˆæ¯..."></textarea></div>
<button class="btn btn-primary" @click="doSendMsg" :disabled="sendingMsg">{{ sendingMsg?'å‘é€ä¸­...':'å‘é€æ¶ˆæ¯' }}</button>
</div>
</div>
</div>
</div>

<div v-if="page==='plugins'">
<div class="page-header"><h1 class="page-title">æ’ä»¶ç®¡ç†</h1><p class="page-desc">ç®¡ç†æœºå™¨äººæ’ä»¶</p></div>
<div class="card">
<div class="table-container">
<table><thead><tr><th>æ’ä»¶åç§°</th><th>ç‰ˆæœ¬</th><th>ä½œè€…</th><th>æè¿°</th><th>çŠ¶æ€</th><th>æ“ä½œ</th></tr></thead>
<tbody><tr v-for="p in plugins" :key="p.name"><td><strong>{{ p.name }}</strong></td><td>v{{ p.version }}</td><td>{{ p.author }}</td><td>{{ p.description || '-' }}</td><td><span class="badge" :class="p.enabled?'badge-success':'badge-danger'">{{ p.enabled?'å·²å¯ç”¨':'å·²ç¦ç”¨' }}</span></td><td><div class="actions"><button class="btn btn-secondary btn-sm" v-if="!p.enabled" @click="doEnablePlugin(p.name)">å¯ç”¨</button><button class="btn btn-secondary btn-sm" v-else @click="doDisablePlugin(p.name)">ç¦ç”¨</button><button class="btn btn-secondary btn-sm" @click="doReloadPlugin(p.name)">é‡è½½</button></div></td></tr></tbody>
</table>
</div>
<div class="empty-state" v-if="plugins.length===0">æš‚æ— æ’ä»¶</div>
</div>
</div>

<div v-if="page==='permissions'">
<div class="page-header"><h1 class="page-title">æƒé™ç®¡ç†</h1><p class="page-desc">ç®¡ç†æœºå™¨äººæƒé™ç”¨æˆ·</p></div>
<div class="card">
<h3 class="card-title">ğŸ”¶ 3çº§ç®¡ç†å‘˜</h3>
<div class="form-group" style="display:flex;gap:12px;margin-bottom:16px;align-items:center"><input type="text" class="form-input" v-model.trim="newAdmin" placeholder="è¾“å…¥QQå·" style="flex:1;min-width:250px" @keyup.enter="doAddAdmin"><button class="btn btn-primary btn-sm" @click="doAddAdmin">æ·»åŠ </button></div>
<div class="table-container"><table><thead><tr><th>QQå·</th><th>æ“ä½œ</th></tr></thead><tbody><tr v-for="qq in perms.admins" :key="qq"><td>{{ qq }}</td><td><button class="btn btn-danger btn-sm" @click="doRemoveAdmin(qq)">ç§»é™¤</button></td></tr></tbody></table></div>
</div>
<div class="card">
<h3 class="card-title">ğŸŸ  4çº§æ‰€æœ‰è€…</h3>
<div class="form-group" style="display:flex;gap:12px;margin-bottom:16px;align-items:center"><input type="text" class="form-input" v-model.trim="newOwner" placeholder="è¾“å…¥QQå·" style="flex:1;min-width:250px" @keyup.enter="doAddOwner"><button class="btn btn-primary btn-sm" @click="doAddOwner">æ·»åŠ </button></div>
<div class="table-container"><table><thead><tr><th>QQå·</th><th>æ“ä½œ</th></tr></thead><tbody><tr v-for="qq in perms.owners" :key="qq"><td>{{ qq }}</td><td><button class="btn btn-danger btn-sm" @click="doRemoveOwner(qq)">ç§»é™¤</button></td></tr></tbody></table></div>
</div>
<div class="card">
<h3 class="card-title">ğŸ”´ 5çº§å¼€å‘è€…</h3>
<div class="form-group" style="display:flex;gap:12px;margin-bottom:16px;align-items:center"><input type="text" class="form-input" v-model.trim="newDev" placeholder="è¾“å…¥QQå·" style="flex:1;min-width:250px" @keyup.enter="doAddDev"><button class="btn btn-primary btn-sm" @click="doAddDev">æ·»åŠ </button></div>
<div class="table-container"><table><thead><tr><th>QQå·</th><th>æ“ä½œ</th></tr></thead><tbody><tr v-for="qq in perms.developers" :key="qq"><td>{{ qq }}</td><td><button class="btn btn-danger btn-sm" @click="doRemoveDev(qq)">ç§»é™¤</button></td></tr></tbody></table></div>
</div>
</div>

<div v-if="page==='blacklist'">
<div class="page-header"><h1 class="page-title">ç¾¤é»‘åå•</h1><p class="page-desc">ç®¡ç†è¢«æ‹‰é»‘çš„ç¾¤</p></div>
<div class="card">
<div class="form-group" style="display:flex;gap:12px;margin-bottom:16px;align-items:center"><input type="text" class="form-input" v-model.trim="newBl" placeholder="è¾“å…¥ç¾¤å·" style="flex:1;min-width:250px" @keyup.enter="doAddBl"><button class="btn btn-primary btn-sm" @click="doAddBl">æ·»åŠ é»‘åå•</button></div>
<div class="table-container"><table><thead><tr><th>ç¾¤å·</th><th>æ“ä½œ</th></tr></thead><tbody><tr v-for="g in blacklist" :key="g"><td>{{ g }}</td><td><button class="btn btn-danger btn-sm" @click="doRemoveBl(g)">ç§»é™¤</button></td></tr></tbody></table></div>
<div class="empty-state" v-if="blacklist.length===0">æš‚æ— é»‘åå•ç¾¤</div>
</div>
</div>

<div v-if="page==='logs'">
<div class="page-header"><h1 class="page-title">å®æ—¶æ—¥å¿—</h1><p class="page-desc">æŸ¥çœ‹æœºå™¨äººè¿è¡Œæ—¥å¿— (WebSocketå®æ—¶æ¨é€)</p></div>
<div class="card">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<span class="stat-label">å®æ—¶æ—¥å¿— (å…±{{ logs.length }}æ¡)</span>
<div class="actions">
<button class="btn btn-secondary btn-sm" @click="autoScroll=!autoScroll">{{ autoScroll?'åœæ­¢æ»šåŠ¨':'è‡ªåŠ¨æ»šåŠ¨' }}</button>
<button class="btn btn-secondary btn-sm" @click="logs=[]">æ¸…ç©º</button>
<button class="btn btn-secondary btn-sm" @click="loadLogs">åˆ·æ–°å†å²</button>
</div>
</div>
<div class="log-container" ref="logBox" style="position:relative;max-height:600px">
<div class="log-line" v-for="(log,i) in logs" :key="i" :class="getLogClass(log)">{{ log }}</div>
<div class="empty-state" v-if="logs.length===0">æš‚æ— æ—¥å¿—</div>
</div>
</div>
</div>

<div v-if="page==='system'">
<div class="page-header"><h1 class="page-title">ç³»ç»Ÿæ“ä½œ</h1><p class="page-desc">æœºå™¨äººç³»ç»Ÿæ§åˆ¶</p></div>
<div class="card">
<h3 class="card-title">âš ï¸ å±é™©æ“ä½œ</h3>
<p style="color:var(--text-secondary);margin-bottom:24px">ä»¥ä¸‹æ“ä½œä¼šå½±å“æœºå™¨äººè¿è¡ŒçŠ¶æ€ï¼Œè¯·è°¨æ…æ“ä½œã€‚</p>
<div class="actions">
<button class="btn btn-warning" @click="showRestart=true">é‡å¯æœºå™¨äºº</button>
<button class="btn btn-danger" @click="showShutdown=true">å…³é—­æœºå™¨äºº</button>
</div>
</div>
</div>
</main>

<div class="modal-overlay" v-if="showRestart" @click.self="showRestart=false">
<div class="modal"><h3 class="modal-title">ç¡®è®¤é‡å¯</h3><p style="color:var(--text-secondary)">ç¡®å®šè¦é‡å¯æœºå™¨äººå—ï¼Ÿé‡å¯æœŸé—´æœºå™¨äººå°†æ— æ³•å“åº”æ¶ˆæ¯ã€‚</p><div class="modal-actions"><button class="btn btn-secondary" @click="showRestart=false">å–æ¶ˆ</button><button class="btn btn-warning" @click="doRestart">ç¡®è®¤é‡å¯</button></div></div>
</div>
<div class="modal-overlay" v-if="showShutdown" @click.self="showShutdown=false">
<div class="modal"><h3 class="modal-title">ç¡®è®¤å…³é—­</h3><p style="color:var(--text-secondary)">ç¡®å®šè¦å…³é—­æœºå™¨äººå—ï¼Ÿå…³é—­åéœ€è¦æ‰‹åŠ¨é‡å¯ã€‚</p><div class="modal-actions"><button class="btn btn-secondary" @click="showShutdown=false">å–æ¶ˆ</button><button class="btn btn-danger" @click="doShutdown">ç¡®è®¤å…³é—­</button></div></div>
</div>
<div class="toast" :class="'toast-'+toast.type" v-if="toast.show">{{ toast.msg }}</div>
</div>
<script type="module">
import{getToken,clearToken,logout,checkAuth}from'/static/js/auth.js';
import{connectWS,disconnectWS}from'/static/js/websocket.js';
import{fetchStatus,fetchPlugins,enablePlugin,disablePlugin,reloadPlugin,fetchPermissions,addAdmin,removeAdmin,addOwner,removeOwner,addDeveloper,removeDeveloper,fetchBlacklist,addBlacklist,removeBlacklist,fetchLogs,fetchGroups,fetchFriends,sendMessage,restartBot,shutdownBot,sanitizeError}from'/static/js/services.js';
const{createApp,ref,reactive,onMounted,onUnmounted,watch,nextTick}=Vue;
createApp({
setup(){
const page=ref('dashboard');
const wsConnected=ref(false);
const token=getToken();
const status=reactive({qq:0,uptime:0,uptime_formatted:'',running:false,adapters:[],plugins_count:0,enabled_plugins_count:0,system:null});
const plugins=ref([]);
const perms=reactive({admins:[],owners:[],developers:[]});
const blacklist=ref([]);
const logs=ref([]);
const autoScroll=ref(true);
const logBox=ref(null);
const msgTab=ref('group');
const groups=ref([]);
const friends=ref([]);
const selected=ref(null);
const msgContent=ref('');
const contactsLoading=ref(false);
const sendingMsg=ref(false);
const newAdmin=ref('');
const newOwner=ref('');
const newDev=ref('');
const newBl=ref('');
const showRestart=ref(false);
const showShutdown=ref(false);
const toast=reactive({show:false,msg:'',type:'success'});
let refreshTimer=null;
const showToast=(msg,type='success')=>{toast.msg=msg;toast.type=type;toast.show=true;setTimeout(()=>{toast.show=false},3000);};
const loadStatus=async()=>{try{Object.assign(status,await fetchStatus(token));}catch(e){}};
const loadPlugins=async()=>{try{plugins.value=await fetchPlugins(token);}catch(e){}};
const loadPerms=async()=>{try{Object.assign(perms,await fetchPermissions(token));}catch(e){}};
const loadBlacklist=async()=>{try{blacklist.value=await fetchBlacklist(token);}catch(e){}};
const loadLogs=async()=>{try{logs.value=await fetchLogs(token);}catch(e){}};
const loadContacts=async()=>{if(msgTab.value==='group'&&groups.value.length===0){contactsLoading.value=true;try{groups.value=await fetchGroups(token);}catch(e){}contactsLoading.value=false;}else if(msgTab.value==='private'&&friends.value.length===0){contactsLoading.value=true;try{friends.value=await fetchFriends(token);}catch(e){}contactsLoading.value=false;}};
const getLogClass=(log)=>{if(log.includes('ERROR')||log.includes('error'))return'log-error';if(log.includes('WARNING')||log.includes('warning'))return'log-warning';if(log.includes('SUCCESS')||log.includes('success'))return'log-success';if(log.includes('INFO')||log.includes('info'))return'log-info';return'';};
const scrollToBottom=()=>{if(autoScroll.value&&logBox.value){nextTick(()=>{logBox.value.scrollTop=logBox.value.scrollHeight;});}};
const doLogout=async()=>{await logout(token);clearToken();disconnectWS();if(refreshTimer)clearInterval(refreshTimer);location.href='/';};
const doSendMsg=async()=>{if(!selected.value||!msgContent.value.trim()){showToast('è¯·é€‰æ‹©è”ç³»äººå¹¶è¾“å…¥æ¶ˆæ¯','error');return;}sendingMsg.value=true;try{await sendMessage(token,msgTab.value,msgTab.value==='private'?selected.value:null,msgTab.value==='group'?selected.value:null,msgContent.value);showToast('æ¶ˆæ¯å‘é€æˆåŠŸ');msgContent.value='';}catch(e){showToast(sanitizeError(e.message),'error');}sendingMsg.value=false;};
const doEnablePlugin=async(name)=>{try{await enablePlugin(token,name);showToast('æ’ä»¶å·²å¯ç”¨');loadPlugins();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doDisablePlugin=async(name)=>{try{await disablePlugin(token,name);showToast('æ’ä»¶å·²ç¦ç”¨');loadPlugins();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doReloadPlugin=async(name)=>{try{await reloadPlugin(token,name);showToast('æ’ä»¶å·²é‡è½½');loadPlugins();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doAddAdmin=async()=>{const qq=parseInt(newAdmin.value);if(!qq||qq<=0){showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„QQå·','error');return;}try{await addAdmin(token,qq);showToast('ç®¡ç†å‘˜å·²æ·»åŠ ');newAdmin.value='';loadPerms();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doRemoveAdmin=async(qq)=>{try{await removeAdmin(token,qq);showToast('ç®¡ç†å‘˜å·²ç§»é™¤');loadPerms();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doAddOwner=async()=>{const qq=parseInt(newOwner.value);if(!qq||qq<=0){showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„QQå·','error');return;}try{await addOwner(token,qq);showToast('æ‰€æœ‰è€…å·²æ·»åŠ ');newOwner.value='';loadPerms();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doRemoveOwner=async(qq)=>{try{await removeOwner(token,qq);showToast('æ‰€æœ‰è€…å·²ç§»é™¤');loadPerms();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doAddDev=async()=>{const qq=parseInt(newDev.value);if(!qq||qq<=0){showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„QQå·','error');return;}try{await addDeveloper(token,qq);showToast('å¼€å‘è€…å·²æ·»åŠ ');newDev.value='';loadPerms();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doRemoveDev=async(qq)=>{try{await removeDeveloper(token,qq);showToast('å¼€å‘è€…å·²ç§»é™¤');loadPerms();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doAddBl=async()=>{const gid=parseInt(newBl.value);if(!gid||gid<=0){showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„ç¾¤å·','error');return;}try{await addBlacklist(token,gid);showToast('å·²æ·»åŠ é»‘åå•');newBl.value='';loadBlacklist();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doRemoveBl=async(gid)=>{try{await removeBlacklist(token,gid);showToast('å·²ç§»é™¤é»‘åå•');loadBlacklist();}catch(e){showToast(sanitizeError(e.message),'error');}};
const doRestart=async()=>{try{await restartBot(token);showRestart.value=false;showToast('æœºå™¨äººæ­£åœ¨é‡å¯...');}catch(e){showToast(sanitizeError(e.message),'error');}};
const doShutdown=async()=>{try{await shutdownBot(token);showShutdown.value=false;showToast('æœºå™¨äººæ­£åœ¨å…³é—­...');}catch(e){showToast(sanitizeError(e.message),'error');}};
const handleWSMsg=(data)=>{if(data.type==='log'){logs.value.push(data.message);if(logs.value.length>500)logs.value.shift();scrollToBottom();}else if(data.type==='plugin_update'){loadPlugins();}else if(data.type==='permission_update'){loadPerms();}else if(data.type==='blacklist_update'){loadBlacklist();}};
const handleWSStatus=(connected,err)=>{if(connected===null&&err==='expired'){showToast('ä¼šè¯å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•','error');doLogout();return;}if(connected===null&&err==='max_conn'){showToast('è¿æ¥æ•°è¿‡å¤š','error');return;}wsConnected.value=connected;};
onMounted(async()=>{if(!token||!await checkAuth(token)){clearToken();location.href='/';return;}loadStatus();loadPlugins();loadPerms();loadBlacklist();connectWS(token,handleWSMsg,handleWSStatus);refreshTimer=setInterval(loadStatus,5000);});
onUnmounted(()=>{disconnectWS();if(refreshTimer)clearInterval(refreshTimer);});
watch(msgTab,()=>{selected.value=null;loadContacts();});
return{page,wsConnected,status,plugins,perms,blacklist,logs,autoScroll,logBox,msgTab,groups,friends,selected,msgContent,contactsLoading,sendingMsg,newAdmin,newOwner,newDev,newBl,showRestart,showShutdown,toast,showToast,loadLogs,loadContacts,getLogClass,doLogout,doSendMsg,doEnablePlugin,doDisablePlugin,doReloadPlugin,doAddAdmin,doRemoveAdmin,doAddOwner,doRemoveOwner,doAddDev,doRemoveDev,doAddBl,doRemoveBl,doRestart,doShutdown};
}
}).mount('#app');
</script>
</body>
</html>
